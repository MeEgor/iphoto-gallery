(function(e){e.fn.iPhoto=function(t){var n=e.extend({extraClass:null,imgTemplate:function(t){return"<img src="+e(t).attr("src")+" alt="+e(t).attr("alt")+" />"}},t),r=e("body");return this.each(function(){var t=e(this);var i=null,s=[],o=null,u=null,a=null;var f=function(){t.addClass("my-iphoto-gallery");if(n.extraClass){t.addClass(n.extraClass)}i=t.outerWidth();s=t.children("img");o=s.length;u=i/o;e(s[0]).addClass("step-now")};var l=function(n){if(n.offsetX==undefined){posx=n.pageX-t.offset().left}else{posx=n.offsetX}step=Math.floor(posx/u);if(step!=a){a=step}s.removeClass("step-now");e(s[step]).addClass("step-now")};f();t.on("mouseenter",function(e){l(e)});t.on("mousemove",function(e){l(e)});t.on("mouseleave",function(t){s.removeClass("step-now");e(s[0]).addClass("step-now");a=null});t.on("click",function(t){var i=e('<div class="gallery-container"></div>'),o=e('<div class="owerlay my-gallery-overlay"></div>');r.css("overflow","hidden");r.append(o.append(i));s.each(function(t,r){image=e(n.imgTemplate(r));image.addClass("my-gallery-image");i.append(image)});o.animate({opacity:1},300);o.on("click",function(t){if(!e(t.target).hasClass("my-gallery-image")){e(this).unbind("click");e(this).animate({opacity:0},300,function(){this.remove()})}})})})}})(jQuery)
